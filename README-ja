------------------------------------------------------------
                     README for kdconv
------------------------------------------------------------

NAME
     kdconv -- PDF optimizer for Kindle2/3/Sony Reader.

SYNOPSIS
     kdconv [-a author] [-ce] [-f deviceformat] [-o]
            [-p devicedoc] [-tv] input-pdf output-pdf

PLATFORM
     - MacOS X 10.6以上(それ以前は未検証)
     - Kindle2/3(KindledDX は未検証)
     - Sony Reader PRS-350

DESCRIPTION
     kdconv は PDF を Kindle2/3、Sony Reader(PRS-350)で読みやすいサイズへ変換
     する為のプログラムです。

     Kindle2/3、Sony Reader では PDF を表示出来ますが、特にデータが画像ファイル
     として埋め込まれたファイルの場合、サイズによっては綺麗に表示されないことが
     あります。このプログラムでは、input-pdf で指定された PDF を、Kindle2/3、
     Sony Reader に適したサイズへ変換し、視認性を高めた後 output-pdf として出力
     します。また、一般的にファイルサイズを小さくする効果もあります。

     Kindle2/3、Sony Reader では、PDF ファイル名末尾の .pdf を除去した値がタイ
     トル名として使用されますので、それを意識して output-pdf を指定すると便利で
     す。

     pdftk がインストールされている環境では output-pdf から、末尾の .pdf を除去
     した値を、PDFのタイトルメタデータとして書きこみます。また、オプションを指
     定することにより、作成者を書きこむことも可能です。作成者名を書き込むと、そ
     の値が Kindle のファイル一覧画面で、作者名として表示されます。

     加えて、余白を取り除く機能や自動的に Kindle2/3、Sony Reader へ転送したりす
     ることも可能です。

     KindleDX 向けに適したサイズへ変換することもできますが、実機をもっていない
     ため、動作確認出来ていません。

PREPARATION
     このプログラムは、以下の外部プログラムへ依存しています。MacPors などを使っ
     て path の通っているディレクトリへインストールしてください。

     - ghostscript(8.71以上)
     - ImageMagick(6.6.1以上)
     - pdftk(1.12以上。ただしインストールはオプション)

     例えば MacPorts で default のままインストールするには:

              sudo port install ghostscript ImageMagick pdftk

     2010/04/13 現在、依存している gcc の build エラーにより、MacPorts では
     pdftk をインストール出来ません。pdftk のページから ver.1.12 バイナリへのリ
     ンクが貼られていますので、それを利用すると良いと思います。pdftk のページ
     は以下の通りです。

              <http://www.accesspdf.com/pdftk/>

     pdftk がインストールされていない場合、-a オプションによる作者名のメタデー
     タ埋め込みが機能しません、その他は動作可能です。

     外部プログラムのインストールが済んだら kdconv をパスの通った適当なディレク
     トリへ install し、実行属性を設定します。例えば /opt/local/bin へインストー
     ルするには:

              sudo install kdconv /opt/local/bin

OPTIONS
     -a AUTHOR
             PDFの作成者を設定します。Kindle はこの値を、作者名として使用しま
             す。このオプションは pdftk がインストールされている環境でのみ使用
             可能です。

     -c      PDF 変換終了後、変換されたファイルを Kindle の documents ディレク
             トリへ自動転送します。Kindle は Mac へ事前に接続しておいてくださ
             い。Kindle が接続されていない場合、警告を表示してなにもしません。
             ouput-pdf へディレクトリ名が含まれている場合でも、コピー時にはファ
             イル名のみが利用されます。

     -e      コピー終了後、Kindle を自動で eject します。-c オプションが付与さ
             れていない場合には意味を持ちません。

     -f      変換対象デバイスを指定します。指定可能な値は、kindle、kindledx、
             sonyreader です。本オプションが指定されない場合のデフォルト値は、
             kindle です。

     -o      output-pdf で指定されたファイルが既に存在している場合、そのファイ
             ルの上書きを許可します。このオプションが指定されていない場合、同
             名のファイルが既に存在した場合には、エラーとなります。

     -p      Kindle2/3 の documents ディレクトリのあるパス、または Sony Reader
             の READER ディレクトリ指定します。デフォルト値は -f の値に依って
             決定されます。

     -t      元ファイルの周辺にある余白を除去しようと試みます。ファイル四隅の
             色を基準に除去領域を判断します。

     -v      バージョンを表示し終了します

EXAMPLES
     foo.pdf を bar.pdf として変換するには:

              kdconv foo.pdf bar.pdf

     sample.pdf を My document.pdf として変換し、自動で Kindle へコピー、その
     後 Kindle を eject させるには:

              kdconv -c -e sample.pdf My\ document.pdf

     1.pdf を out.pdf として余白を除去しながら変換し、既に存在する out.pdf へ
     上書き出力させるには:

              kdconv -t -o 1.pdf out.pdf

BUGS
     バグを発見された場合には、下記、AUTHOR までご連絡ください。

     もとのPDFがベクタデータで作成されている場合、生成されたファイルはもとのファ
     イルよりも表示エリアが縮小された、または読みにくいファイルとなることがあります。

     稀に ImageMagick の convert が暴走し、変換が終了しない場合があります。
     この場合には再度変換をやり直してみてください。

SPECIAL THANKS
     以下の方々から有益なご指摘やパッチを頂き、より使いやすいスクリプトにする
     ことが出来ました。感謝いたします。

     Noriaki Mitsunaga さん:
     - script をより汎用化する方法、ならびに、Kindle2/3 でより綺麗に表示する解
       像度設定を教えてくださいました。

     @toplut さん:
     - pdftk の output が非ASCII文字ファイル名に対応していないことを教えてく
       ださいました。

AUTHOR
     E-Mail: n-miyo@tempus.org
     Twitter: nmiyo
     Blog: http://blogger.tempus.org/

; EOF
